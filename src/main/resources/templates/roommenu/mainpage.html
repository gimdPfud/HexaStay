<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>커스텀 드롭다운 예제</title>
    <style>
        /* 커스텀 드롭다운 컨테이너 */
        .custom-dropdown {
            position: relative;
            display: inline-block;
            width: 200px;
            font-family: 'Open Sans', sans-serif;
            font-size: 16px;
        }

        /* 현재 선택된 옵션 영역 스타일 */
        .custom-dropdown .selected-option {
            border: 1px solid #ccc;
            background: #fff;
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* 옵션 목록 스타일 */
        .custom-dropdown .options {
            list-style-type: none;
            padding: 0;
            margin: 0;
            border: 1px solid #ccc;
            border-top: none;
            position: absolute;
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
            background: #fff;
            display: none; /* 기본 상태는 숨겨짐 */
            z-index: 100;
        }
        .custom-dropdown .options li {
            padding: 8px 12px;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .custom-dropdown .options li:hover {
            background: #f0f0f0;
        }

        /* 국기 아이콘 스타일 */
        .flag {
            width: 24px;
            height: 18px;
            background-image: url('flags.png'); /* 상대경로 사용 */
            background-repeat: no-repeat;
            display: inline-block;
            margin-right: 8px;
        }
        .flag-ko { background-position: -29px -207px; }
        .flag-ja { background-position: -87px -178px; }
        .flag-en { background-position: -116px -352px; }
        .flag-cn { background-position: 0px -62px; }
    </style>
</head>
<body>
<!-- 커스텀 드롭다운 컨테이너 -->
<div class="custom-dropdown" id="languageDropdown">
    <!-- 현재 선택된 옵션 (클릭시 옵션 목록 토글) -->
    <div class="selected-option" tabindex="0">
        <span class="flag flag-ko"></span>
        <span class="option-text">한국어</span>
        <span>&#9662;</span> <!-- ▼ 화살표 -->
    </div>
    <!-- 옵션 목록 -->
    <ul class="options">
        <li data-value="ko">
            <span class="flag flag-ko"></span>
            <span>한국어</span>
        </li>
        <li data-value="en">
            <span class="flag flag-en"></span>
            <span>English</span>
        </li>
        <li data-value="ja">
            <span class="flag flag-ja"></span>
            <span>日本語</span>
        </li>
        <li data-value="cn">
            <span class="flag flag-cn"></span>
            <span>中國語</span>
        </li>
    </ul>
    <!-- 선택된 값을 저장할 Hidden Input (폼 제출 시 사용) -->
    <input type="hidden" name="lang" value="ko">
</div>

<script>
    // 커스텀 드롭다운 기본 기능 구현
    const dropdown = document.getElementById('languageDropdown');
    const selected = dropdown.querySelector('.selected-option');
    const optionsContainer = dropdown.querySelector('.options');
    const optionsList = optionsContainer.querySelectorAll('li');
    const hiddenInput = dropdown.querySelector('input[name="lang"]');

    // 드롭다운 토글: 선택 영역 클릭 시 옵션 목록을 보이거나 숨깁니다.
    selected.addEventListener('click', (e) => {
        e.stopPropagation(); // 클릭 이벤트가 부모로 전파되지 않도록 함
        optionsContainer.style.display = optionsContainer.style.display === 'block' ? 'none' : 'block';
    });

    // 각 옵션 클릭 시 선택 처리
    optionsList.forEach(option => {
        option.addEventListener('click', () => {
            // 옵션 내 플래그와 텍스트를 가져옴
            const flagHTML = option.querySelector('.flag').outerHTML;
            const text = option.querySelector('span:nth-of-type(2)').textContent;

            // 선택된 영역 업데이트 (플래그 + 텍스트 + 화살표)
            selected.innerHTML = flagHTML + '<span class="option-text">' + text + '</span><span>&#9662;</span>';

            // Hidden input 업데이트
            hiddenInput.value = option.getAttribute('data-value');

            // 옵션 목록 숨기기
            optionsContainer.style.display = 'none';

            // 필요에 따라 폼을 자동 제출할 수 있음
            // document.querySelector('form').submit();
        });
    });

    // 드롭다운 외부 클릭 시 옵션 목록을 닫는 기능
    document.addEventListener('click', (event) => {
        if (!dropdown.contains(event.target)) {
            optionsContainer.style.display = 'none';
        }
    });

    // 키보드 접근성을 위한 이벤트 (Enter, Space, Escape 등)
    selected.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            // Space 또는 Enter 키로 토글
            e.preventDefault();
            optionsContainer.style.display = optionsContainer.style.display === 'block' ? 'none' : 'block';
        } else if (e.key === 'Escape') {
            optionsContainer.style.display = 'none';
        }
    });
</script>
</body>
</html>
