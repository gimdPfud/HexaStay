<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>자주 묻는 질문</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <!-- Add jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.js"></script>  <style>
    .accordion-button:not(.collapsed) {
      background-color: #dbeafe;
    }
  </style>
</head>
<div class="accordion" id="faqAccordion">
  <div class="accordion-item" th:each="faq : ${faqList}">
    <h2 class="accordion-header" th:attr="id='heading-' + ${faq.faqNum}">
      <button class="accordion-button collapsed" type="button"
              data-bs-toggle="collapse"
              th:attr="data-bs-target='#collapse-' + ${faq.faqNum}"
              aria-expanded="false"
              th:attrappend="aria-controls='collapse-' + ${faq.faqNum}">
        <span th:text="${faq.faqTitle}">제목</span>
      </button>
    </h2>
    <div class="accordion-collapse collapse"
         th:attr="id='collapse-' + ${faq.faqNum}"
         th:attrappend="aria-labelledby='heading-' + ${faq.faqNum}"
         data-bs-parent="#faqAccordion">
      <div class="accordion-body">

        <!-- ✅ 기본 보기 영역 -->
        <div th:id="'viewMode-' + ${faq.faqNum}">
          <p th:text="${faq.faqContent}">내용</p>
          <div class="text-end mt-2">
            <button class="btn btn-sm btn-outline-secondary"
                    th:attr="onclick='enableEdit(' + ${faq.faqNum} + ')'"
            >수정</button>
          </div>
        </div>

        <!-- ✅ 수정 영역 -->
        <form th:action="@{/faq/modify}" method="post"
              th:id="'editForm-' + ${faq.faqNum}"
              th:object="${faq}" style="display:none;">
          <input type="hidden" name="faqNum" th:value="${faq.faqNum}" />
          <div class="mb-2">
            <textarea class="form-control" name="faqContent" rows="3"
                      th:text="${faq.faqContent}"></textarea>
          </div>
          <div class="text-end">
            <button type="submit" class="btn btn-sm btn-primary">저장</button>
            <button type="button" class="btn btn-sm btn-secondary"
                    th:attr="onclick='cancelEdit(' + ${faq.faqNum} + ')'"
            >취소</button>
          </div>
        </form>
        <form th:action="@{/faq/delete}" method="post" class="d-inline">
          <input type="hidden" name="faqNum" th:value="${faq.faqNum}" />
          <button class="btn btn-sm btn-danger">삭제</button>
        </form>
      </div>
    </div>
  </div>
</div>
<script>
  function enableEdit(faqNum) {
    document.getElementById('viewMode-' + faqNum).style.display = 'none';
    document.getElementById('editForm-' + faqNum).style.display = 'block';
  }

  function cancelEdit(faqNum) {
    document.getElementById('editForm-' + faqNum).style.display = 'none';
    document.getElementById('viewMode-' + faqNum).style.display = 'block';
  }
</script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
</body>
</html>
