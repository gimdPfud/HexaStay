<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout.html}">

<head>
    <meta charset="UTF-8">
    <title>Ïû¨Î¨¥ Ï†ïÏÇ∞ Ï∞®Ìä∏</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .chart-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.05);
        }

        .form-select {
            max-width: 200px;
            margin-right: 15px;
        }

        .download-btn {
            float: right;
        }

        table {
            font-size: 0.9rem;
        }

        canvas {
            background-color: #fff;
            border-radius: 10px;
        }
    </style>
</head>

<body>
<div layout:fragment="content" class="container mt-5">

    <h2 class="mb-4 fw-bold text-primary">Ïû¨Î¨¥ Ï†ïÏÇ∞ Ï∞®Ìä∏</h2>

    <!-- üîΩ ÏÑ†ÌÉù ÌïÑÌÑ∞ -->
    <div class="d-flex flex-wrap align-items-center mb-4">
        <select class="form-select" id="hqSelect">
            <option selected>Î≥∏ÏÇ¨ ÏÑ†ÌÉù</option>
            <option>ÏÑúÏö∏Î≥∏ÏÇ¨</option>
            <option>Î∂ÄÏÇ∞Î≥∏ÏÇ¨</option>
        </select>
        <select class="form-select" id="branchSelect">
            <option selected>ÏßÄÏÇ¨ ÏÑ†ÌÉù</option>
            <option>Ï§ëÎ∂ÄÏßÄÏÇ¨</option>
            <option>ÎÇ®Î∂ÄÏßÄÏÇ¨</option>
        </select>
        <select class="form-select" id="officeSelect">
            <option selected>ÏßÄÏ†ê ÏÑ†ÌÉù</option>
            <option>Í∞ïÎÇ®ÏßÄÏ†ê</option>
            <option>ÎåÄÍµ¨ÏßÄÏ†ê</option>
        </select>
        <select class="form-select" id="storeSelect">
            <option selected>Ïä§ÌÜ†Ïñ¥ ÏÑ†ÌÉù</option>
            <option>Ïä§ÌÜ†Ïñ¥ A</option>
            <option>Ïä§ÌÜ†Ïñ¥ B</option>
        </select>
        <button class="btn btn-success download-btn">ÏóëÏÖÄÎ°ú Îã§Ïö¥Î°úÎìú</button>
    </div>

    <!-- üìä ÌÖåÏù¥Î∏î & Ï∞®Ìä∏ -->
    <div class="chart-section">

        <!-- ÌÖåÏù¥Î∏î -->
        <div class="table-responsive">
            <table class="table table-bordered text-center">
                <thead class="table-primary">
                <tr>
                    <th>ÎÇ†Ïßú</th>
                    <th>Îß§Ï∂ú Í∏àÏï°</th>
                    <th>ÏàòÏàòÎ£åÏú®</th>
                    <th>ÏàòÏàòÎ£å</th>
                    <th>Í≥µÏ†ú Í∏àÏï°</th>
                    <th>ÏµúÏ¢Ö Ï†ïÏÇ∞ Í∏àÏï°</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>2025-04-01</td>
                    <td>‚Ç©1,200,000</td>
                    <td>5%</td>
                    <td>‚Ç©60,000</td>
                    <td>‚Ç©10,000</td>
                    <td>‚Ç©1,130,000</td>
                </tr>
                <tr>
                    <td>2025-04-02</td>
                    <td>‚Ç©950,000</td>
                    <td>5%</td>
                    <td>‚Ç©47,500</td>
                    <td>‚Ç©10,000</td>
                    <td>‚Ç©892,500</td>
                </tr>
                <tr>
                    <td>2025-04-03</td>
                    <td>‚Ç©800,000</td>
                    <td>5%</td>
                    <td>‚Ç©40,000</td>
                    <td>‚Ç©10,000</td>
                    <td>‚Ç©750,000</td>
                </tr>
                <tr>
                    <td>2025-04-04</td>
                    <td>‚Ç©1,500,000</td>
                    <td>5%</td>
                    <td>‚Ç©75,000</td>
                    <td>‚Ç©10,000</td>
                    <td>‚Ç©1,415,000</td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- üìä Ï∞®Ìä∏Îì§ -->
        <div class="row mt-5">
            <div class="col-lg-8 mb-4">
                <h5 class="mb-3">Îß§Ï∂ú & Ï†ïÏÇ∞ Ï∂îÏù¥</h5>
                <canvas id="mixedChart" height="260"></canvas>
            </div>
            <div class="col-lg-4">
                <h5 class="mb-3">Ï†ïÏÇ∞ ÎπÑÏú® Î∂ÑÏÑù</h5>
                <canvas id="donutChart" height="260"></canvas>
            </div>
        </div>
    </div>

</div>

<!-- Chart.js Ïä§ÌÅ¨Î¶ΩÌä∏ -->
<script>
    // ÌòºÌï©Ìòï Ï∞®Ìä∏ (Îß§Ï∂ú + Ï†ïÏÇ∞Ïï°)
    const mixedCtx = document.getElementById('mixedChart').getContext('2d');
    new Chart(mixedCtx, {
        type: 'bar',
        data: {
            labels: ['4/1', '4/2', '4/3', '4/4'],
            datasets: [
                {
                    type: 'bar',
                    label: 'Îß§Ï∂ú Í∏àÏï°',
                    data: [1200000, 950000, 800000, 1500000],
                    backgroundColor: '#0d6efd'
                },
                {
                    type: 'line',
                    label: 'ÏµúÏ¢Ö Ï†ïÏÇ∞ Í∏àÏï°',
                    data: [1130000, 892500, 750000, 1415000],
                    borderColor: '#198754',
                    borderWidth: 3,
                    fill: false,
                    tension: 0.4,
                    pointBackgroundColor: '#198754'
                }
            ]
        },
        options: {
            responsive: true,
            interaction: {
                mode: 'index',
                intersect: false
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `${context.dataset.label}: ‚Ç©${context.raw.toLocaleString()}`;
                        }
                    }
                }
            },
            scales: {
                y: {
                    ticks: {
                        callback: val => '‚Ç©' + val.toLocaleString()
                    }
                }
            }
        }
    });

    // ÎèÑÎÑõ Ï∞®Ìä∏ (Ï†ïÏÇ∞ ÎπÑÏú® Î∂ÑÏÑù)
    const donutCtx = document.getElementById('donutChart').getContext('2d');
    new Chart(donutCtx, {
        type: 'doughnut',
        data: {
            labels: ['ÏàòÏàòÎ£å Ìï©Í≥Ñ', 'Í≥µÏ†ú Í∏àÏï° Ìï©Í≥Ñ', 'Ï†ïÏÇ∞Ïï° Ìï©Í≥Ñ'],
            datasets: [{
                data: [222500, 40000, 4197500],
                backgroundColor: ['#ffc107', '#dc3545', '#198754']
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'bottom'
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `${context.label}: ‚Ç©${context.raw.toLocaleString()}`;
                        }
                    }
                }
            }
        }
    });
</script>

</body>
</html>
