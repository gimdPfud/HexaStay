<div id="navbarorder" class="navbarorder" th:fragment="navbarorder">
    <nav class="navbar navbar-light bg-white border-bottom">
        <div class="container d-flex justify-content-between align-items-center">

            <!-- 좌측: 뒤로가기 -->
            <div style="width: 100px;">
                <button class="btn btn-link p-0" onclick="history.back()">
                    <i class="bi bi-arrow-left fs-1" style="color: #77b1fb;"></i>
                </button>
            </div>

            <!-- 중앙: 타이틀 -->
            <div class="text-center flex-grow-1">
                <a href="/main" style="text-decoration: none;">
                    <span class="fw-bold" style="font-size: 24px;">주문</span>
                </a>
            </div>

            <div style="width: 100px; text-align: right;">
                <!-- 주문내역 아이콘 -->
                <a href="/receipt" class="d-inline-block me-2">
                    <i class="bi bi-receipt-cutoff fs-3"></i>
                </a>

                <!-- 장바구니 -->
                <a href="/cart/gocart" class="position-relative d-inline-block">
                    <i class="bi bi-cart4 fs-3"></i>
                    <span id="cartnumber"
                          class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                          style="display: none;"></span>
                </a>
            </div>


        </div>
    </nav>

    <script th:inline="javascript">
        let cartnumber = document.getElementById("cartnumber");
        document.addEventListener("DOMContentLoaded", function () {
            fetch("/cart/getlength", {
                credentials: 'same-origin'
            })
                .then(response => {
                    return response.text();  // 서버가 숫자(1,2 등)만 내려주면 text() 써도 OK
                })
                .then(data => {
                    console.log("응답 테스트:", data);

                    const cartnumber = document.getElementById("cartnumber");

                    const count = parseInt(data);

                    if (!isNaN(count)) {
                        if (count > 0) {
                            cartnumber.textContent = count;
                            cartnumber.style.display = "inline-block";
                        } else {
                            cartnumber.style.display = "none";
                        }
                    } else {
                        console.warn("숫자로 파싱 안 됨:", data);
                    }
                });

        });
    </script>

</div>
